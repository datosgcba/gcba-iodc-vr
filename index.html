<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>#historiascondatos - ¿Qué hay detrás de los datos abiertos? </title>
    <meta name="description" content="Una nueva forma de descubrir los datos de la ciudad.">
    
    <script src="libs/aframe.min.js"></script>
    <script src="libs/aframe-animation-component.min.js"></script> 
    <script src="libs/aframe-event-set-component.js"></script>
    <script src="libs/aframe-layout-component.min.js"></script> 
    <script src="libs/aframe-template-component.min.js"></script> 
    <script src="libs/aframe-look-at-component.min.js"></script>
    <script src="https://unpkg.com/aframe-border-component@0.1.3/dist/aframe-border-component.min.js"></script>   

    <script src="libs/d3/d3.min.js"></script>
    <script src="libs/nunjucks.min.js"> </script>
    <script src="components/set-image.js"></script>
    <script src="components/show-detail.js"></script>
    <script src="components/go-to-lobby.js"></script>
    <script src="components/go-to-matrix.js"></script>
    <script src="components/go-to-trip.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        
        <audio id="click-sound" crossorigin="anonymous" src="https://cdn.aframe.io/360-image-gallery-boilerplate/audio/click.ogg"></audio>
        
        
        <img id="margot" crossorigin="anonymous" src="stories/01/margot/assets/photos/adentro-dia.jpg">
        <img id="borges" crossorigin="anonymous" src="stories/01/borges/img/bgEscena1.jpg">
        <img id="eter" crossorigin="anonymous" src="stories/01/eternauta/02-01-devoto-4.jpg">
        <img id="santelmo" crossorigin="anonymous" src="stories/01/santelmo/img/bgEscena1.jpg">


        <img id="lobby" crossorigin="anonymous" src="images/lobby/00.png">


        <img id="administracion-thumb" crossorigin="anonymous" src="images/posters/poster-administracion.png">
        <img id="ambiente-thumb" crossorigin="anonymous" src="images/posters/poster-ambiente.png">
        <img id="cultura-thumb" crossorigin="anonymous" src="images/posters/poster-cultura.png">
        <img id="actividad_economica-thumb" crossorigin="anonymous" src="images/posters/poster-economica.png">
        <img id="educacion-thumb" crossorigin="anonymous" src="images/posters/poster-educacion.png">
        <img id="movilidad-thumb" crossorigin="anonymous" src="images/posters/poster-movilidad.png">
        <img id="obra-thumb" crossorigin="anonymous" src="images/posters/poster-obra.png">
        <img id="salud-thumb" crossorigin="anonymous" src="images/posters/poster-salud.png">
        <img id="urbanismo-thumb" crossorigin="anonymous" src="images/posters/poster-urbanismo.png">
        <img id="seguridad-thumb" crossorigin="anonymous" src="images/posters/poster-seguridad.png">



        <img id="khipu" crossorigin="anonymous" src="stories/02/khipu/rooftop.jpg">
        <img id="sonrisa" crossorigin="anonymous" src="stories/02/sonria/img-1.jpg">
        <img id="terror" crossorigin="anonymous" src="stories/02/terror/Escena-03-negativo.jpg">
        
        <script id="dataset-detail-menu" type="text/x-nunjucks-template">
          <a-entity geometry="primitive: plane; width: 4; height: 4;" material="shader: flat; color: white">

            <a-entity layout="type: box;align:start; columns:1;reverse:true; margin: 0.6; plane:xy;" position="0 -1 0">
                <a-text color="black" value="{{currentDetail.titulo}}" width="4" word-wrap="30" align="center"></a-text>
                <a-text color="black" value="{{currentDetail.tamanio}} filas" align="center"></a-text>
                <a-text color="black" value="{{currentDetail.frecuencia}}" align="center"></a-text>
               
                   <a-text color="black" value="{{currentDetail.descripcion}}" wrap-count="50" align="center"></a-text>
              
               
                 <a-entity go-to-detail="on: click;item:{{x.id}}"
                    event-set__1="_event: mousedown; scale: 1 1 1"
                    event-set__2="_event: mouseup; scale: 1.2 1.2 1"
                    event-set__3="_event: mouseenter; scale: 1.2 1.2 1"
                    event-set__4="_event: mouseleave; scale: 1 1 1" geometry="primitive: plane; width: 3; height: 0.5;" material="shader: flat; color: yellow" 
                sound="on: click; src: #click-sound"
                position="0 0 0" color="black" text="value: Explora una muestra; align:center">
                
                   
                  </a-entity>
          </a-entity>
        </script>
      
        <script id="rectangle-menu" type="text/x-nunjucks-template">
            
              <a-entity position="0 4 0" layout="type: circle; radius: 4; plane:xz;">
              {% for x in range(0,5) %}
                <a-entity look-at="[camera]" template="src: #poster" data-src="#lobby" data-thumb="#{{currentCategory.key}}-thumb"></a-entity>
               {% endfor %}
          </a-entity>
           <a-entity layout="type: circle; radius: 8; plane:xz;"  position="0 0.5 0">
            {% for x in currentCategory.firstGroup %}
            <a-entity look-at="[camera]" layout="type: box; columns:1; margin: 0.85; plane:xy;">
                <a-entity>
                  <a-entity  class="item" position="0 0 1" scale="0.5 0.5 0.5" geometry="primitive: plane; width: 4; height: 4;" material="side:double; shader: flat; color: transparent" show-detail="on: click;item:{{x.id}}" >
                    <a-entity geometry="primitive: plane; width: 4; height: 4;" material="side: front">
                      <a-text  align="center" color="black" value="{{x.titulo}}"  width="3.75" wrap-count="15" align="center"></a-text>
                     <a-text  align="center" position="0 1.25 0" color="black" value="(X)"  width="3.75" wrap-count="15" align="center"></a-text>
                     </a-entity>
                     <a-entity class="detail" position="0 0 -0.2" rotation="0 180 0" geometry="primitive: plane; width: 4; height: 4;" material="side: front">
                     </a-entity>
                  </a-entity>
                </a-entity>
                <a-entity >
                    <a-entity position="0 {{x.barPosition}} 0" geometry="primitive: plane;width:1;height:{{x.barLength}}" material="side:double; shader: flat; color: white" >
                    </a-entity>
                </a-entity>
                
            </a-entity>
            {% endfor %}
       
            </a-entity>

         <a-entity layout="type: circle; radius: 8; plane:xz;"  position="0 -1.5 0">
            {% for x in currentCategory.secondGroup %}
            <a-entity layout="type: box; columns:1; margin: 0.85; plane:xy;">
                <a-entity look-at="[camera]">
                    <a-entity position="0 -{{x.barPosition}} 0" geometry="primitive: plane;width:1;height:{{x.barLength}}" material="shader: flat; color: white" >
                    </a-entity>
                </a-entity>

                <a-entity look-at="[camera]" scale="0.5 0.5 0.5" geometry="primitive: plane; width: 4; height: 4;" material="shader: flat; color: transparent" show-detail="on: click;item:{{x.id}}" >
                   <a-text  align="center" color="black" value="{{x.titulo}}"  width="4" wrap-count="18" align="center"></a-text>
                   <a-entity class="back-description">
                     
                   </a-entity>
                </a-entity>
            </a-entity>
            {% endfor %}
       
            </a-entity>
     
        </script>

     <!-- Image link template to be reused. -->
      <script id="circle-menu" type="text/x-nunjucks-template">
        <a-entity layout="type: circle; radius: 6; plane:xz;">
            
            {% for x in categories %}
               <a-entity look-at="[camera]" template="src: #link" data-src="#margot" data-link="{{x.key}}" data-thumb="#{{x.key}}-thumb" data-percentage="{{x.percentage}}" data-count="{{x.values.length}}" data-rows="{{x.rowsLabel}}"></a-entity>
            {% endfor %}
             
      </a-entity>
     
        </script>
      
        <!-- Image link template to be reused. -->
        <script id="poster" type="text/html">
          <!-- <a-entity layout="type: line;columns:1; margin: 0.25;"> -->
          <a-entity look-at="[camera]" class="link"
            geometry="primitive: plane; height: 2; width: 1.3"
            material="side:double;shader: flat; src: ${thumb}"
            event-set__1="_event: mousedown; scale: 1 1 1"
            event-set__2="_event: mouseup; scale: 1.2 1.2 1"
            event-set__3="_event: mouseenter; scale: 1.2 1.2 1"
            event-set__4="_event: mouseleave; scale: 1 1 1"
            go-to-lobby="on: click; target: #image-360; src: ${src}"
            sound="on: click; src: #click-sound"></a-entity>
          <!-- </a-entity> -->
        </script>
      </a-assets>
        
        <!-- Image link template to be reused. -->
        <script id="link" type="text/html">
          
          <a-entity look-at="[camera]" class="link"
            geometry="primitive: plane; height: 2.5; width: 2"
            material="side:double;shader: flat; src: ${thumb}"
            event-set__1="_event: mousedown; scale: 1 1 1"
            event-set__2="_event: mouseup; scale: 1.2 1.2 1"
            event-set__3="_event: mouseenter; scale: 1.2 1.2 1"
            event-set__4="_event: mouseleave; scale: 1 1 1"
            set-image="on: click; link:${link};target: #image-360; src: ${src}"
            sound="on: click; src: #click-sound"
            "></a-entity>
            <a-entity look-at="[camera]" position="0.012676036232893928 1.509007219788657 0.00863929409054304"  geometry="primitive: plane; width: 2; height: 0.35;" material="shader: flat; color: white">
              <a-text color="black" value="${count} datasets" align="center" text=""></a-text>
            </a-entity>
            <a-entity>
              
              <a-entity look-at="[camera]" position="0.012676036232893928 -1.526007219788657 0.00963929409054304"  geometry="primitive: plane; width: ${percentage*2/100}; height: 0.35;" material="shader: flat; color: red">
              </a-entity>
              <a-entity look-at="[camera]" position="0.012676036232893928 -1.526007219788657 0.00863929409054304"  geometry="primitive: plane; width: 2; height: 0.35;" material="shader: flat; color: transparent"> 
                <a-text align="center" color="black" value="${percentage}% del Total" align="center" text=""></a-text>
              </a-entity>
            </a-entity>
            <a-entity look-at="[camera]" position="0.012676036232893928 -1.986007219788657 0.00863929409054304" geometry="primitive: plane; width: 2; height: 0.35;" material="shader: flat; color: white">
              <a-text color="black" value="${rows} filas" align="center" text=""></a-text>
            </a-entity>
          <!-- </a-entity> -->
        </script>
      </a-assets>


      <!-- 360-degree image. -->
      <a-sky id="image-360" radius="100" src="#lobby" color="white"></a-sky>
      <!-- Miradas Logo -->
   
  <!-- Miradas Logo -->
      <a-entity position="0 0 -2.5"
            geometry="primitive: plane; height: 1; width: 2.6"
            material="transparent:true;side:double;shader: flat; src: images/Miradas_Logo.png;opacity: 0">
                <a-animation attribute="material.opacity" 
                duration="2000"
                 to="1"></a-animation>
              <a-animation attribute="position" 
                duration="4200"
                begin="4200"
                 from="0 0 -2.5"
                 to="0 1 -2.5">
                   
                 </a-animation>
                  <a-animation attribute="material.opacity" 
                begin="20000"
                duration="5000"
                from="1"
                 to="0"></a-animation>
                   <a-animation attribute="visible"   begin="20000"
                duration="5000"  to="false"></a-animation>

            </a-entity>
              <!-- Miradas Logo -->
      <a-entity position="0 0 -1.5"
            geometry="primitive: plane; height: 1; width: 1.65"
            material="transparent:true;side:double;shader: flat; src: images/Label.png;opacity: 0">
                <a-animation attribute="material.opacity" 
                duration="4200"
                begin="4200"
                 to="1"></a-animation>
                  <a-animation attribute="material.opacity" 
                begin="20000"
                duration="5000"
                from="1"
                 to="0"></a-animation>
                <a-animation attribute="visible"   begin="20000"
                duration="5000"  to="false"></a-animation>

            </a-entity>
               



      <a-entity id="lobby-circle"></a-entity> 
      <a-entity id="category-circle"></a-entity> 
      <a-entity id="detail-circle"></a-entity> 


      <!-- Camera + cursor. -->
      <a-entity camera look-controls>
        <a-cursor id="cursor"
          animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1 1 1; dur: 150"
          animation__fusing="property: fusing; startEvents: fusing; from: 1 1 1; to: 0.1 0.1 0.1; dur: 1500"
          event-set__1="_event: mouseenter; color: springgreen"
          event-set__2="_event: mouseleave; color: black"
          fuse="true"></a-cursor>
      </a-entity>
    </a-scene>
    <script src="components/main.js"></script>
  </body>
</html>
